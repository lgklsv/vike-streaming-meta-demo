import{S as q,p as Q,r as p,s as w,a as T,n as V,i as E,b as I,t as $,f as N,c as K,d as k,e as H,g as y,u as G,h as J,j as X,k as d,F as Y,W as Z,L as ee,o as te}from"../chunks/chunk-DKm9RdR2.js";import{g as se}from"../chunks/chunk-B9D2Y4am.js";/* empty css                      *//* empty css                      *//* empty css                      */var re=class extends q{constructor(e,t){super(),this.options=t,this.#s=e,this.#r=null,this.#i=Q(),this.options.experimental_prefetchInRender||this.#i.reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(t)}#s;#e=void 0;#p=void 0;#t=void 0;#n;#u;#i;#r;#y;#c;#d;#o;#l;#a;#f=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(this.#e.addObserver(this),z(this.#e,this.options)?this.#h():this.updateResult(),this.#m())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return P(this.#e,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return P(this.#e,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#S(),this.#R(),this.#e.removeObserver(this)}setOptions(e,t){const s=this.options,r=this.#e;if(this.options=this.#s.defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof p(this.options.enabled,this.#e)!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#T(),this.#e.setOptions(this.options),s._defaulted&&!w(this.options,s)&&this.#s.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#e,observer:this});const n=this.hasListeners();n&&A(this.#e,r,this.options,s)&&this.#h(),this.updateResult(t),n&&(this.#e!==r||p(this.options.enabled,this.#e)!==p(s.enabled,this.#e)||T(this.options.staleTime,this.#e)!==T(s.staleTime,this.#e))&&this.#v();const h=this.#g();n&&(this.#e!==r||p(this.options.enabled,this.#e)!==p(s.enabled,this.#e)||h!==this.#a)&&this.#b(h)}getOptimisticResult(e){const t=this.#s.getQueryCache().build(this.#s,e),s=this.createResult(t,e);return ae(this,s)&&(this.#t=s,this.#u=this.options,this.#n=this.#e.state),s}getCurrentResult(){return this.#t}trackResult(e,t){const s={};return Object.keys(e).forEach(r=>{Object.defineProperty(s,r,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(r),t?.(r),e[r])})}),s}trackProp(e){this.#f.add(e)}getCurrentQuery(){return this.#e}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const t=this.#s.defaultQueryOptions(e),s=this.#s.getQueryCache().build(this.#s,t);return s.fetch().then(()=>this.createResult(s,t))}fetch(e){return this.#h({...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#t))}#h(e){this.#T();let t=this.#e.fetch(this.options,e);return e?.throwOnError||(t=t.catch(V)),t}#v(){this.#S();const e=T(this.options.staleTime,this.#e);if(E||this.#t.isStale||!I(e))return;const s=$(this.#t.dataUpdatedAt,e)+1;this.#o=setTimeout(()=>{this.#t.isStale||this.updateResult()},s)}#g(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.#e):this.options.refetchInterval)??!1}#b(e){this.#R(),this.#a=e,!(E||p(this.options.enabled,this.#e)===!1||!I(this.#a)||this.#a===0)&&(this.#l=setInterval(()=>{(this.options.refetchIntervalInBackground||N.isFocused())&&this.#h()},this.#a))}#m(){this.#v(),this.#b(this.#g())}#S(){this.#o&&(clearTimeout(this.#o),this.#o=void 0)}#R(){this.#l&&(clearInterval(this.#l),this.#l=void 0)}createResult(e,t){const s=this.#e,r=this.options,n=this.#t,h=this.#n,i=this.#u,o=e!==s?e.state:this.#p,{state:u}=e;let a={...u},S=!1,c;if(t._optimisticResults){const l=this.hasListeners(),g=!l&&z(e,t),b=l&&A(e,s,t,r);(g||b)&&(a={...a,...K(u.data,e.options)}),t._optimisticResults==="isRestoring"&&(a.fetchStatus="idle")}let{error:U,errorUpdatedAt:j,status:v}=a;if(t.select&&a.data!==void 0)if(n&&a.data===h?.data&&t.select===this.#y)c=this.#c;else try{this.#y=t.select,c=t.select(a.data),c=k(n?.data,c,t),this.#c=c,this.#r=null}catch(l){this.#r=l}else c=a.data;if(t.placeholderData!==void 0&&c===void 0&&v==="pending"){let l;if(n?.isPlaceholderData&&t.placeholderData===i?.placeholderData)l=n.data;else if(l=typeof t.placeholderData=="function"?t.placeholderData(this.#d?.state.data,this.#d):t.placeholderData,t.select&&l!==void 0)try{l=t.select(l),this.#r=null}catch(g){this.#r=g}l!==void 0&&(v="success",c=k(n?.data,l,t),S=!0)}this.#r&&(U=this.#r,c=this.#c,j=Date.now(),v="error");const x=a.fetchStatus==="fetching",C=v==="pending",O=v==="error",D=C&&x,F=c!==void 0,f={status:v,fetchStatus:a.fetchStatus,isPending:C,isSuccess:v==="success",isError:O,isInitialLoading:D,isLoading:D,data:c,dataUpdatedAt:a.dataUpdatedAt,error:U,errorUpdatedAt:j,failureCount:a.fetchFailureCount,failureReason:a.fetchFailureReason,errorUpdateCount:a.errorUpdateCount,isFetched:a.dataUpdateCount>0||a.errorUpdateCount>0,isFetchedAfterMount:a.dataUpdateCount>o.dataUpdateCount||a.errorUpdateCount>o.errorUpdateCount,isFetching:x,isRefetching:x&&!C,isLoadingError:O&&!F,isPaused:a.fetchStatus==="paused",isPlaceholderData:S,isRefetchError:O&&F,isStale:_(e,t),refetch:this.refetch,promise:this.#i};if(this.options.experimental_prefetchInRender){const l=R=>{f.status==="error"?R.reject(f.error):f.data!==void 0&&R.resolve(f.data)},g=()=>{const R=this.#i=f.promise=Q();l(R)},b=this.#i;switch(b.status){case"pending":e.queryHash===s.queryHash&&l(b);break;case"fulfilled":(f.status==="error"||f.data!==b.value)&&g();break;case"rejected":(f.status!=="error"||f.error!==b.reason)&&g();break}}return f}updateResult(e){const t=this.#t,s=this.createResult(this.#e,this.options);if(this.#n=this.#e.state,this.#u=this.options,this.#n.data!==void 0&&(this.#d=this.#e),w(s,t))return;this.#t=s;const r={},n=()=>{if(!t)return!0;const{notifyOnChangeProps:h}=this.options,i=typeof h=="function"?h():h;if(i==="all"||!i&&!this.#f.size)return!0;const m=new Set(i??this.#f);return this.options.throwOnError&&m.add("error"),Object.keys(this.#t).some(o=>{const u=o;return this.#t[u]!==t[u]&&m.has(u)})};e?.listeners!==!1&&n()&&(r.listeners=!0),this.#x({...r,...e})}#T(){const e=this.#s.getQueryCache().build(this.#s,this.options);if(e===this.#e)return;const t=this.#e;this.#e=e,this.#p=e.state,this.hasListeners()&&(t?.removeObserver(this),e.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#m()}#x(e){H.batch(()=>{e.listeners&&this.listeners.forEach(t=>{t(this.#t)}),this.#s.getQueryCache().notify({query:this.#e,type:"observerResultsUpdated"})})}};function ie(e,t){return p(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function z(e,t){return ie(e,t)||e.state.data!==void 0&&P(e,t,t.refetchOnMount)}function P(e,t,s){if(p(t.enabled,e)!==!1){const r=typeof s=="function"?s(e):s;return r==="always"||r!==!1&&_(e,t)}return!1}function A(e,t,s,r){return(e!==t||p(r.enabled,e)===!1)&&(!s.suspense||e.state.status!=="error")&&_(e,s)}function _(e,t){return p(t.enabled,e)!==!1&&e.isStaleByTime(T(t.staleTime,e))}function ae(e,t){return!w(e.getCurrentResult(),t)}var W=y.createContext(!1),ne=()=>y.useContext(W);W.Provider;function oe(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var le=y.createContext(oe()),he=()=>y.useContext(le);function ue(e,t){return typeof e=="function"?e(...t):!!e}function L(){}var ce=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},de=e=>{y.useEffect(()=>{e.clearReset()},[e])},fe=({result:e,errorResetBoundary:t,throwOnError:s,query:r,suspense:n})=>e.isError&&!t.isReset()&&!e.isFetching&&r&&(n&&e.data===void 0||ue(s,[e.error,r])),pe=(e,t)=>t.state.data===void 0,ye=e=>{const t=e.staleTime;e.suspense&&(e.staleTime=typeof t=="function"?(...s)=>Math.max(t(...s),1e3):Math.max(t??1e3,1e3),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3)))},ve=(e,t)=>e.isLoading&&e.isFetching&&!t,ge=(e,t)=>e?.suspense&&t.isPending,M=(e,t,s)=>t.fetchOptimistic(e).catch(()=>{s.clearReset()});function be(e,t,s){const r=G(),n=ne(),h=he(),i=r.defaultQueryOptions(e);r.getDefaultOptions().queries?._experimental_beforeQuery?.(i),i._optimisticResults=n?"isRestoring":"optimistic",ye(i),ce(i,h),de(h);const m=!r.getQueryCache().get(i.queryHash),[o]=y.useState(()=>new t(r,i)),u=o.getOptimisticResult(i),a=!n&&e.subscribed!==!1;if(y.useSyncExternalStore(y.useCallback(S=>{const c=a?o.subscribe(H.batchCalls(S)):L;return o.updateResult(),c},[o,a]),()=>o.getCurrentResult(),()=>o.getCurrentResult()),y.useEffect(()=>{o.setOptions(i,{listeners:!1})},[i,o]),ge(i,u))throw M(i,o,h);if(fe({result:u,errorResetBoundary:h,throwOnError:i.throwOnError,query:r.getQueryCache().get(i.queryHash),suspense:i.suspense}))throw u.error;return r.getDefaultOptions().queries?._experimental_afterQuery?.(i,u),i.experimental_prefetchInRender&&!E&&ve(u,n)&&(m?M(i,o,h):r.getQueryCache().get(i.queryHash)?.promise)?.catch(L).finally(()=>{o.updateResult()}),i.notifyOnChangeProps?u:o.trackResult(u)}function me(e,t){return be({...e,enabled:!0,suspense:!0,throwOnError:pe,placeholderData:void 0},re)}function Se(){let e=se();return e?t=>B(t,e):(e=J(),t=>{"_headAlreadySet"in e?Re(t):B(t,e)})}function B(e,t){t._configFromHook??(t._configFromHook={}),Object.assign(t._configFromHook,e)}function Re(e){const{title:t,lang:s}=e;X(t,s)}function Te(e){return Se()(e),null}function xe(){return null}function Ce(){const t=me({queryKey:["movies"],queryFn:()=>fetch("https://star-wars.brillout.com/api/films.json").then(s=>s.json())}).data.results;return d.jsxs(d.Fragment,{children:[d.jsx(Te,{title:`${t.length} Star Wars Movies`}),d.jsx(xe,{children:d.jsx("meta",{name:"description",content:`All ${t.length} movies from the Star Wars franchise.`})}),d.jsx("h1",{children:"Star Wars Movies"}),d.jsx("ol",{children:t.map(s=>d.jsxs("li",{children:[d.jsx("a",{href:`/star-wars/${s.episode_id}`,children:s.title})," (",s.release_date,")"]},s.episode_id))}),d.jsxs("p",{children:["Source: ",d.jsx("a",{href:"https://brillout.github.io/star-wars",children:"brillout.github.io/star-wars"}),"."]})]})}const Oe=Object.freeze(Object.defineProperty({__proto__:null,default:Ce},Symbol.toStringTag,{value:"Module"})),we={layout:Ee};function Ee(){return d.jsx("div",{children:d.jsx("h1",{children:"Loading..."})})}const Pe=Object.freeze(Object.defineProperty({__proto__:null,default:we},Symbol.toStringTag,{value:"Module"})),Ie={isClientRuntimeLoaded:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:!0}},onBeforeRenderEnv:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:null}},dataEnv:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:null}},onRenderClient:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react/__internal/integration/onRenderClient",fileExportPathToShowToUser:[]},valueSerialized:{type:"pointer-import",value:te}},Page:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/star-wars/index/+Page.tsx",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:Oe}},hydrationCanBeAborted:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react/config",fileExportPathToShowToUser:["default","hydrationCanBeAborted"]},valueSerialized:{type:"js-serialized",value:!0}},Layout:{type:"cumulative",definedAtData:[{filePathToShowToUser:"/layouts/LayoutDefault.tsx",fileExportPathToShowToUser:[]}],valueSerialized:[{type:"pointer-import",value:ee}]},title:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/+config.ts",fileExportPathToShowToUser:["default","title"]},valueSerialized:{type:"js-serialized",value:"My Vike App"}},Wrapper:{type:"cumulative",definedAtData:[{filePathToShowToUser:"vike-react-query/__internal/integration/Wrapper",fileExportPathToShowToUser:[]}],valueSerialized:[{type:"pointer-import",value:Z}]},Loading:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/star-wars/index/+Loading.tsx",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:Pe}},queryClientConfig:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react-query/config",fileExportPathToShowToUser:["default","queryClientConfig"]},valueSerialized:{type:"js-serialized",value:"!undefined"}},FallbackErrorBoundary:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react-query/__internal/integration/FallbackErrorBoundary",fileExportPathToShowToUser:[]},valueSerialized:{type:"pointer-import",value:Y}}};export{Ie as configValuesSerialized};
